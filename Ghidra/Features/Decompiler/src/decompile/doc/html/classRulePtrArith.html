<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>decompiler: RulePtrArith Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">decompiler
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="classRulePtrArith-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">RulePtrArith Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Transform pointer arithmetic.  
 <a href="classRulePtrArith.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for RulePtrArith:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classRulePtrArith.png" usemap="#RulePtrArith_map" alt=""/>
  <map id="RulePtrArith_map" name="RulePtrArith_map">
<area href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode." alt="Rule" shape="rect" coords="0,0,80,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afe0c04cbed0b86e6c09ca29f4514531f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classRule.html">Rule</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRulePtrArith.html#afe0c04cbed0b86e6c09ca29f4514531f">clone</a> (const <a class="el" href="classActionGroupList.html">ActionGroupList</a> &amp;grouplist) const</td></tr>
<tr class="memdesc:afe0c04cbed0b86e6c09ca29f4514531f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRulePtrArith.html#afe0c04cbed0b86e6c09ca29f4514531f">More...</a><br /></td></tr>
<tr class="separator:afe0c04cbed0b86e6c09ca29f4514531f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1671af63d66f70ec2746887d32dfa46e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRulePtrArith.html#a1671af63d66f70ec2746887d32dfa46e">getOpList</a> (vector&lt; uint4 &gt; &amp;oplist) const</td></tr>
<tr class="memdesc:a1671af63d66f70ec2746887d32dfa46e"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of op codes this rule operates on.  <a href="classRulePtrArith.html#a1671af63d66f70ec2746887d32dfa46e">More...</a><br /></td></tr>
<tr class="separator:a1671af63d66f70ec2746887d32dfa46e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b6d5d16ceb0884f97bebd712b9f6852"><td class="memItemLeft" align="right" valign="top">virtual int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRulePtrArith.html#a8b6d5d16ceb0884f97bebd712b9f6852">applyOp</a> (<a class="el" href="classPcodeOp.html">PcodeOp</a> *op, <a class="el" href="classFuncdata.html">Funcdata</a> &amp;data)</td></tr>
<tr class="memdesc:a8b6d5d16ceb0884f97bebd712b9f6852"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to apply <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRulePtrArith.html#a8b6d5d16ceb0884f97bebd712b9f6852">More...</a><br /></td></tr>
<tr class="separator:a8b6d5d16ceb0884f97bebd712b9f6852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classRule"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classRule')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classRule.html">Rule</a></td></tr>
<tr class="memitem:af34899104f25035253a67d4d2665d0bf inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#af34899104f25035253a67d4d2665d0bf">Rule</a> (const string &amp;g, uint4 fl, const string &amp;nm)</td></tr>
<tr class="memdesc:af34899104f25035253a67d4d2665d0bf inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct given group, properties name.  <a href="classRule.html#af34899104f25035253a67d4d2665d0bf">More...</a><br /></td></tr>
<tr class="separator:af34899104f25035253a67d4d2665d0bf inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfe310fc05ec8dfb8d46953158d76f2 inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#a8bfe310fc05ec8dfb8d46953158d76f2">checkActionBreak</a> (void)</td></tr>
<tr class="memdesc:a8bfe310fc05ec8dfb8d46953158d76f2 inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an action breakpoint is turned on.  <a href="classRule.html#a8bfe310fc05ec8dfb8d46953158d76f2">More...</a><br /></td></tr>
<tr class="separator:a8bfe310fc05ec8dfb8d46953158d76f2 inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f074d593a6fefc79a5c07e4b3e13674 inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#a1f074d593a6fefc79a5c07e4b3e13674">reset</a> (<a class="el" href="classFuncdata.html">Funcdata</a> &amp;data)</td></tr>
<tr class="memdesc:a1f074d593a6fefc79a5c07e4b3e13674 inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRule.html#a1f074d593a6fefc79a5c07e4b3e13674">More...</a><br /></td></tr>
<tr class="separator:a1f074d593a6fefc79a5c07e4b3e13674 inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc634cc8f189a6641aac6e24e2473103 inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#adc634cc8f189a6641aac6e24e2473103">resetStats</a> (void)</td></tr>
<tr class="memdesc:adc634cc8f189a6641aac6e24e2473103 inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> statistics.  <a href="classRule.html#adc634cc8f189a6641aac6e24e2473103">More...</a><br /></td></tr>
<tr class="separator:adc634cc8f189a6641aac6e24e2473103 inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e0ad50a132df1b33b7705ccdea01b3 inherit pub_methods_classRule"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#a80e0ad50a132df1b33b7705ccdea01b3">printStatistics</a> (ostream &amp;s) const</td></tr>
<tr class="memdesc:a80e0ad50a132df1b33b7705ccdea01b3 inherit pub_methods_classRule"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print statistics for <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRule.html#a80e0ad50a132df1b33b7705ccdea01b3">More...</a><br /></td></tr>
<tr class="separator:a80e0ad50a132df1b33b7705ccdea01b3 inherit pub_methods_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aeee620729160863696b7abdd63a689f3"><td class="memItemLeft" align="right" valign="top">static int4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRulePtrArith.html#aeee620729160863696b7abdd63a689f3">evaluatePointerExpression</a> (<a class="el" href="classPcodeOp.html">PcodeOp</a> *op, int4 slot)</td></tr>
<tr class="memdesc:aeee620729160863696b7abdd63a689f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the expression rooted at the given INT_ADD operation is ready for conversion.  <a href="classRulePtrArith.html#aeee620729160863696b7abdd63a689f3">More...</a><br /></td></tr>
<tr class="separator:aeee620729160863696b7abdd63a689f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a3da5af01f5d8e177941da33de7853899"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRulePtrArith.html#a3da5af01f5d8e177941da33de7853899">verifyPreferredPointer</a> (<a class="el" href="classPcodeOp.html">PcodeOp</a> *op, int4 slot)</td></tr>
<tr class="memdesc:a3da5af01f5d8e177941da33de7853899"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test for other pointers in the ADD tree above the given op that might be a preferred base.  <a href="classRulePtrArith.html#a3da5af01f5d8e177941da33de7853899">More...</a><br /></td></tr>
<tr class="separator:a3da5af01f5d8e177941da33de7853899"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classRule"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classRule')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classRule.html">Rule</a></td></tr>
<tr class="memitem:a605c4d4f6690f01deb9aa08c358fbc43 inherit pub_types_classRule"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43">typeflags</a> { <a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43abee2f75196ccb896f6288ba044adcf93">type_disable</a> = 1, 
<a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43abe38bd9cfb49aea7e6cb1bf46a88ad20">rule_debug</a> = 2, 
<a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43a42bedddab8f9d5f8fcfd165b0f8fb3e3">warnings_on</a> = 4, 
<a class="el" href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43a50c94d6ecacaf041c1b9dde93a4df022">warnings_given</a> = 8
 }</td></tr>
<tr class="memdesc:a605c4d4f6690f01deb9aa08c358fbc43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Properties associated with a <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>.  <a href="classRule.html#a605c4d4f6690f01deb9aa08c358fbc43">More...</a><br /></td></tr>
<tr class="separator:a605c4d4f6690f01deb9aa08c358fbc43 inherit pub_types_classRule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Transform pointer arithmetic. </p>
<p><a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> for converting integer arithmetic to pointer arithmetic. A string of INT_ADDs is converted into PTRADDs and PTRSUBs.</p>
<p>Basic algorithm: Starting with a varnode of known pointer type (with known size):</p><ul>
<li>Generate list of terms added to pointer</li>
<li>Find all terms that are multiples of pointer size</li>
<li>Find all terms that are smaller than pointer size</li>
<li>Find sum of constants smaller than pointer size</li>
<li>Multiples get converted to PTRADD</li>
<li>Constant gets converted to nearest subfield offset</li>
<li>Everything else is just added back on</li>
</ul>
<p>We need to be wary of most things being in the units of the space being pointed at. Type calculations are always in bytes so we need to convert between space units and bytes. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a8b6d5d16ceb0884f97bebd712b9f6852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b6d5d16ceb0884f97bebd712b9f6852">&#9670;&nbsp;</a></span>applyOp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int4 RulePtrArith::applyOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFuncdata.html">Funcdata</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to apply <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>. </p>
<p>This method contains the main logic for applying the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>. It must use a given <a class="el" href="classPcodeOp.html" title="Lowest level operation of the p-code language.">PcodeOp</a> as the point at which the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> applies. If it does apply, changes are made directly to the function and 1 (non-zero) is returned, otherwise 0 is returned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>is the given <a class="el" href="classPcodeOp.html" title="Lowest level operation of the p-code language.">PcodeOp</a> where the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> may apply </td></tr>
    <tr><td class="paramname">data</td><td>is the function to which to apply </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classRule.html#a4e3e61f066670175009f60fb9dc60848">Rule</a>.</p>

<p class="reference">References <a class="el" href="classAddTreeState.html#a1fba7b1b0b2a97ada10a8a59ab2e6cd4">AddTreeState::apply()</a>, <a class="el" href="classRulePtrArith.html#aeee620729160863696b7abdd63a689f3">evaluatePointerExpression()</a>, <a class="el" href="classAddTreeState.html#adcc12ebd25e5593a37fcff5d61ef8e4c">AddTreeState::initAlternateForm()</a>, <a class="el" href="type_8hh.html#aef6429f2523cdf4d415ba04a0209e61fa311715f465e358409d513be004f82b2f">TYPE_PTR</a>, and <a class="el" href="classRulePtrArith.html#a3da5af01f5d8e177941da33de7853899">verifyPreferredPointer()</a>.</p>

</div>
</div>
<a id="afe0c04cbed0b86e6c09ca29f4514531f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe0c04cbed0b86e6c09ca29f4514531f">&#9670;&nbsp;</a></span>clone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classRule.html">Rule</a>* RulePtrArith::clone </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classActionGroupList.html">ActionGroupList</a> &amp;&#160;</td>
          <td class="paramname"><em>grouplist</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clone the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>. </p>
<p>If <b>this</b> <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> is a member of one of the groups in the grouplist, this returns a clone of the <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a>, otherwise NULL is returned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grouplist</td><td>is the list of groups being cloned </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the cloned <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> or NULL </dd></dl>

<p>Implements <a class="el" href="classRule.html#a70de90a76461bfa7ea0b575ce3c11e4d">Rule</a>.</p>

<p class="reference">References <a class="el" href="classActionGroupList.html#a1da632f21f5671ecabc3c0551e787041">ActionGroupList::contains()</a>.</p>

</div>
</div>
<a id="aeee620729160863696b7abdd63a689f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeee620729160863696b7abdd63a689f3">&#9670;&nbsp;</a></span>evaluatePointerExpression()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int4 RulePtrArith::evaluatePointerExpression </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>slot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if the expression rooted at the given INT_ADD operation is ready for conversion. </p>
<p>Converting an expression of INT_ADDs into PTRSUBs and PTRADDs requires that the base pointer be at the root of the expression tree. This method evaluates whether given root has the base pointer at the bottom. If not, a <em>push</em> transform needs to be performed before <a class="el" href="classRulePtrArith.html" title="Transform pointer arithmetic.">RulePtrArith</a> can apply. This method returns a command code:</p><ul>
<li>0 if no action should be taken, the expression is not fully linked or should not be converted</li>
<li>1 if a <em>push</em> action should be taken, prior to conversion</li>
<li>2 if the pointer arithmetic conversion can proceed <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>is the given INT_ADD </td></tr>
    <tr><td class="paramname">slot</td><td>is the index of the pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the command code </dd></dl>
</li>
</ul>

<p class="reference">References <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ab13948fae3194faced3994780ca08061">CPUI_INT_ADD</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ad76724dd2fcd9df1dca7e09e6427f10f">CPUI_LOAD</a>, <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a14ab8d826af51873faa33b33e2bbc5fb">CPUI_STORE</a>, <a class="el" href="classPcodeOp.html#a3bf80a4ef518e6a41cc0f0e8ae08e7b4">PcodeOp::getSlot()</a>, <a class="el" href="classVarnode.html#a4282416957775b013b40588efe862ed6">Varnode::getTypeReadFacing()</a>, and <a class="el" href="type_8hh.html#aef6429f2523cdf4d415ba04a0209e61fa311715f465e358409d513be004f82b2f">TYPE_PTR</a>.</p>

<p class="reference">Referenced by <a class="el" href="classRulePtrArith.html#a8b6d5d16ceb0884f97bebd712b9f6852">applyOp()</a>, <a class="el" href="classRulePushPtr.html#a6785d1d9de50ecb56918711aa413d7dc">RulePushPtr::applyOp()</a>, and <a class="el" href="classRulePtrArith.html#a3da5af01f5d8e177941da33de7853899">verifyPreferredPointer()</a>.</p>

</div>
</div>
<a id="a1671af63d66f70ec2746887d32dfa46e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1671af63d66f70ec2746887d32dfa46e">&#9670;&nbsp;</a></span>getOpList()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RulePtrArith::getOpList </td>
          <td>(</td>
          <td class="paramtype">vector&lt; uint4 &gt; &amp;&#160;</td>
          <td class="paramname"><em>oplist</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List of op codes this rule operates on. </p>
<p>Populate the given array with all possible OpCodes this <a class="el" href="classRule.html" title="Class for performing a single transformation on a PcodeOp or Varnode.">Rule</a> might apply to. By default, this method returns all possible OpCodes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">oplist</td><td>is the array to populate </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classRule.html#a4023bfc7825de0ab866790551856d10e">Rule</a>.</p>

<p class="reference">References <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ab13948fae3194faced3994780ca08061">CPUI_INT_ADD</a>.</p>

</div>
</div>
<a id="a3da5af01f5d8e177941da33de7853899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3da5af01f5d8e177941da33de7853899">&#9670;&nbsp;</a></span>verifyPreferredPointer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool RulePtrArith::verifyPreferredPointer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPcodeOp.html">PcodeOp</a> *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int4&#160;</td>
          <td class="paramname"><em>slot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test for other pointers in the ADD tree above the given op that might be a preferred base. </p>
<p>This tests the condition of <a class="el" href="classRulePushPtr.html" title="Push a Varnode with known pointer data-type to the bottom of its additive expression.">RulePushPtr</a> on the node immediately above the given putative base pointer </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>is the given op </td></tr>
    <tr><td class="paramname">slot</td><td>is the input slot of the putative base pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if the indicated slot holds the preferred pointer </dd></dl>

<p class="reference">References <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7ab13948fae3194faced3994780ca08061">CPUI_INT_ADD</a>, <a class="el" href="classRulePtrArith.html#aeee620729160863696b7abdd63a689f3">evaluatePointerExpression()</a>, and <a class="el" href="type_8hh.html#aef6429f2523cdf4d415ba04a0209e61fa311715f465e358409d513be004f82b2f">TYPE_PTR</a>.</p>

<p class="reference">Referenced by <a class="el" href="classRulePtrArith.html#a8b6d5d16ceb0884f97bebd712b9f6852">applyOp()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="ruleaction_8hh.html">ruleaction.hh</a></li>
<li>ruleaction.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
